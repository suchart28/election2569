<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECT Data Insights - ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡∏ï‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f0f2f5; color: #1a1a1a; }
        .hero-section { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 40px 0; margin-bottom: 30px; border-radius: 0 0 30px 30px; }
        .stats-card { border: none; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.05); transition: 0.3s; }
        .table-container { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
        .search-box { border-radius: 50px; padding-left: 25px; border: 2px solid #eee; }
        .search-box:focus { border-color: #2a5298; box-shadow: none; }
        .btn-export { border-radius: 50px; padding: 10px 25px; font-weight: 600; transition: 0.3s; }
        .badge-cons { background: #e3f2fd; color: #0d47a1; font-weight: 600; }
        .sticky-header { position: sticky; top: 0; background: white; z-index: 100; padding: 10px 0; }
    </style>
</head>
<body>

<div class="hero-section text-center">
    <div class="container">
        <h1 class="display-5 fw-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡∏ï‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á</h1>
        <p class="lead opacity-75">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏™‡∏™. ‡∏£‡∏≤‡∏¢‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á ‡∏Å‡∏Å‡∏ï.)</p>
    </div>
</div>

<div class="container">
    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="card stats-card p-4 text-center">
                <h6 class="text-muted text-uppercase small">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</h6>
                <h2 class="fw-bold text-primary" id="stat-prov">0</h2>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stats-card p-4 text-center">
                <h6 class="text-muted text-uppercase small">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ç‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h6>
                <h2 class="fw-bold text-success" id="stat-cons">0</h2>
            </div>
        </div>
        <div class="col-md-4">
            <button onclick="exportToExcel()" class="btn btn-success btn-export w-100 h-100 shadow-sm">
                üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô Excel (.xlsx)
            </button>
        </div>
    </div>

    <div class="table-container">
        <div class="row g-3 mb-4 sticky-header">
            <div class="col-md-8">
                <input type="text" id="searchInput" class="form-control search-box lg" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≥‡πÄ‡∏†‡∏≠, ‡∏ï‡∏≥‡∏ö‡∏•)...">
            </div>
            <div class="col-md-4">
                <select id="sortOrder" class="form-select search-box" onchange="handleSort()">
                    <option value="asc">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏°‡∏≤‡∏Å)</option>
                    <option value="desc">‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î (‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢)</option>
                </select>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-borderless align-middle" id="mainTable">
                <thead>
                    <tr class="border-bottom text-muted">
                        <th>‡∏£‡∏´‡∏±‡∏™</th>
                        <th>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
                        <th>‡πÄ‡∏Ç‡∏ï‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á</th>
                        <th>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï</th>
                    </tr>
                </thead>
                <tbody id="dataTable">
                    </tbody>
            </table>
        </div>
        <div id="noData" class="text-center py-5 d-none">
            <h5 class="text-muted">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...</h5>
        </div>
    </div>
</div>

<footer class="text-center py-5 text-muted">
    <small>¬© 2026 Election Dashboard - Powered by GitHub Pages</small>
</footer>

<script>
    let rawData = [];
    let currentData = [];

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    async function init() {
        try {
            const response = await fetch('data.json');
            rawData = await response.json();
            currentData = [...rawData];
            
            updateDashboard();
        } catch (error) {
            console.error("Load error:", error);
            document.getElementById('dataTable').innerHTML = `<tr><td colspan="4" class="text-center text-danger py-5">‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå data.json ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Repository ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</td></tr>`;
        }
    }

    function updateDashboard() {
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
        const uniqueProvs = [...new Set(currentData.map(item => item.prov_id))].length;
        document.getElementById('stat-prov').innerText = uniqueProvs;
        document.getElementById('stat-cons').innerText = currentData.length;

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        const tbody = document.getElementById('dataTable');
        const noData = document.getElementById('noData');
        
        if (currentData.length === 0) {
            tbody.innerHTML = '';
            noData.classList.remove('d-none');
        } else {
            noData.classList.add('d-none');
            tbody.innerHTML = currentData.map(item => `
                <tr class="border-bottom">
                    <td><small class="text-muted fw-bold">${item.prov_id}</small></td>
                    <td><span class="fw-bold text-dark">${item.prov_name}</span></td>
                    <td><span class="badge badge-cons p-2">‡πÄ‡∏Ç‡∏ï ${item.cons_no}</span></td>
                    <td class="text-muted small">${item.area_description || '-'}</td>
                </tr>
            `).join('');
        }
    }

    // ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
    document.getElementById('searchInput').addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        currentData = rawData.filter(item => 
            item.prov_name.toLowerCase().includes(term) || 
            (item.area_description && item.area_description.toLowerCase().includes(term))
        );
        updateDashboard();
    });

    // ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö
    function handleSort() {
        const order = document.getElementById('sortOrder').value;
        currentData.sort((a, b) => {
            return order === 'asc' ? a.prov_id - b.prov_id : b.prov_id - a.prov_id;
        });
        updateDashboard();
    }

    // ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å Excel
    function exportToExcel() {
        const ws = XLSX.utils.json_to_sheet(currentData);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Election_Data");
        XLSX.writeFile(wb, "ect_constituency_data.xlsx");
    }

    init();
</script>

</body>
</html>
